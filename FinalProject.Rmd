---
title: 'Analysis of Traffic Crash Patterns and Their Contributing Factors'
author: "Your Name"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: cosmo
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## Introduction

This analysis explores traffic crash patterns in our dataset, focusing on key factors that influence crash occurrence and severity. We investigate the relationships between speed limits, vehicle types, substance abuse, and various other factors that contribute to traffic accidents.

## Data Preparation

```{r load-libraries}
# Load required libraries
library(dplyr)
library(ggplot2)
library(tidyr)
library(lubridate)
library(scales)
```

```{r load-data}
# Load the dataset
crash_data <- read.csv("US.csv")

# Initial data cleaning and preprocessing
crash_clean <- crash_data %>%
  # Add your cleaning steps here
  na.omit()  # Remove NA values (adjust as needed)
```

## Analysis 1: Speed Zones and Crash Patterns

### Research Question
What speed zones result in the most crashes, and how does this affect crash severity?

```{r speed-analysis}
# Analysis of crashes by speed limit

# Assuming your data frame is called 'crash_data'
speed_limit_crashes <- table(crash_data$Speed.Limit)
speed_limit_summary <- data.frame(
    speed_limit = names(speed_limit_crashes),
    crash_count = as.numeric(speed_limit_crashes)
)

# Sort by crash count in descending order
speed_limit_summary <- speed_limit_summary[order(-speed_limit_summary$crash_count), ]

# View the results
print(speed_limit_summary)

# Create a bar plot
library(ggplot2)
ggplot(speed_limit_summary, aes(x = speed_limit, y = crash_count)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    theme_minimal() +
    labs(
        title = "Crash Frequency by Speed Limit",
        x = "Speed Limit",
        y = "Number of Crashes"
    ) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Visualization code will go here
```

## Analysis 2: Vehicle Types in Crashes

### Research Question
What car types are most commonly found in crashes, and is there a relationship with crash severity?

```{r vehicle-analysis}
# Analysis of crashes by vehicle type
vehicle_summary <- crash_clean %>%
  group_by(Vehicle.Body.Type) %>%
  summarise(
    crash_count = n(),
    severe_crashes = sum(Injury.Severity %in% c("FATAL INJURY", "SUSPECTED SERIOUS INJURY")),
    severity_rate = severe_crashes / crash_count
  )

# Visualization code will go here
```

## Analysis 3: Substance Abuse and Injury Correlation

### Research Question
Is there a higher injury rate correlated with substance abuse?

```{r substance-analysis}
# Analysis of substance abuse and injury severity
substance_summary <- crash_clean %>%
  group_by(Driver.Substance.Abuse) %>%
  summarise(
    crash_count = n(),
    severe_crashes = sum(Injury.Severity %in% c("FATAL INJURY", "SUSPECTED SERIOUS INJURY")),
    severity_rate = severe_crashes / crash_count
  )

# Visualization code will go here
```

## Analysis 4: Factors Affecting Crash Severity

### Research Question
What factors correlate most strongly with crash severity?

```{r severity-analysis}
# Analysis of various factors and their correlation with severity
# Consider factors like:
# - Weather conditions
# - Time of day
# - Traffic control presence
# - Driver distraction
# - Vehicle movement

# Code for correlation analysis will go here
```

## Statistical Testing

```{r statistical-tests}
# Chi-square tests, regression analysis, or other appropriate statistical tests
# will be added here based on the specific relationships we're testing
```

## Conclusions

[Your conclusions will go here after completing the analysis]

## Recommendations

[Your recommendations based on the findings will go here]

## References

[Add any references or data sources used]